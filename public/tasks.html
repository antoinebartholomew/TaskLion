<!DOCTYPE html>
<html lang="en">

<head>
  <title>Tasks</title>
  <!-- Required meta tags-->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/solid.css" integrity="sha384-v2Tw72dyUXeU3y4aM2Y0tBJQkGfplr39mxZqlTBDUZAb9BGoC40+rdFCG0m10lXk"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/fontawesome.css" integrity="sha384-q3jl8XQu1OpdLgGFvNRnPdj5VIlCvgsDQTQB6owSOHWlAurxul7f+JpUOVdAiJ5P"
        crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="/css/style.css" type="text/css">
    <script src="js/home.js"></script>
    <script src="js/forgotPass.js"></script>
    <script src="js/taskrs.js"></script>
    <script src="js/tasks.js"></script>
  <!--body content ===============================================================================================-->
</head>

<body>

  <div class="container">
    <div class="row">
      <div class="offset-md-8 col-md-1">
        <a class="btn btn-primary" href="/home">Home </a>
      </div>
      <div class="col-md-1">
        <a class="btn btn-primary" href="/user/settings/:user">Settings</a>
      </div>
      <div class="col-md-1">
        <a class="btn btn-primary" href="/create">Create</a>
      </div>
      <div class="col-md-1">
        <button id="logoutSubmit" class="btn btn-primary">Logout</button>
      </div>
    </div>
  </div>


  <!-- <div class="form-group">
          <label for="categorySelect">Select Category</label>
          <select class="form-control" id="categorySelect">
            <option>Auto Maintenance</option>
            <option>Childcare</option>
            <option>Culinary</option>
            <option>Event Planning</option>
            <option>Home Maintenance</option>
            <option>Instruction</option>
    </select>
  </div>


  <div class="container">
    <div class="row">
      <form>
        <div class="form-group">
          <label for="categorySelect">Select Category</label>
          <select class="form-control" id="categorySelect">
            <option>Auto Maintenance</option>
            <option>Childcare</option>
            <option>Culinary</option>
            <option>Event Planning</option>
            <option>Home Maintenance</option>
            <option>Instruction</option>
          </select>
        </div>
        <button id='categorySubmit' type="submit" class="btn btn-primary submit">Filter</button>
      </form>
    </div>
  </div> -->


  <div class="container rowBackground ">
    <div class="row marginTop">
        <div class="form-group btn">
          <!-- <label for="categorySelect">Select Category</label> -->
          <select class="form-control" id="categorySelect">
            <option>Auto Maintenance</option>
            <option>Childcare</option>
            <option>Culinary</option>
            <option>Event Planning</option>
            <option>Home Maintenance</option>
            <option>Instruction</option>
          </select>
        </div>
        <button id='categorySubmit' type="submit" class="btn btn-primary btnHeight">Filter</button>
    </div>
    <div class="row">
      <table class="table rowBackground">
        <thead>
          <tr class="text-left">
            <th scope="col">Task</th>
            <th style="width: 30%">Description</th>
            <th scope="col">Price</th>
            <th scope="col">Day of Week</th>
            <th scope="col">Category</th>
            <th scope="col">Book</th>
          </tr>
        </thead>
        <tbody id="userTasks">
  
        </tbody>
      </table>
    </div>
  </div>




  <!-- <div class="container rowBackground ">
    <div class="row">
      <div id="userPostedTask"></div>
    </div>
  </div> -->

  <!-- Optional JavaScript-->
  <!-- jQuery first, then Popper.js, then Bootstrap JS-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

</body>
<script>
  // List all available tasks on page load
  $.ajax("/api/availabletasks", {
    type: "GET",
  }).then(function(dbTasks) {
    console.log('dbTasks', dbTasks);
    var tasksArray = dbTasks;
    for (let i = 0; i < tasksArray.length; i++) {
      let title = tasksArray[i].title;
      let body = tasksArray[i].body;
      let price = tasksArray[i].price;
      let dow = tasksArray[i].dayofWeek;
      let cat = tasksArray[i].category;
      let taskid = tasksArray[i].id;
      // let glypicon1 = (<span onclick="editTask()"><i class="fas fa-edit glypiconSpace"></i></span>)
      var newrow = $("<tr>");
      // newrow.attr("data-key2", taskid)
      newrow.append($("<td class='text-left'>" + title + "</td>"));
      newrow.append($("<td class='text-left'>" + body + "</td>"));
      newrow.append($("<td class='text-left'>" + price + "</td>"));
      newrow.append($("<td class='text-left'>" + dow + "</td>"));
      newrow.append($("<td class='text-left'>" + cat + "</td>"));
      newrow.append($("<td><span onclick=bookTask() i class='fas fa-check-square glypiconSpace' data='" + taskid + "'></i></td>"))
      $("#userTasks").append(newrow);
      // $("#userPostedTask").append( `
      //               <div class="row">
      //                   <div class="col-md-2">
      //                       <h6>Task:</h6>
      //                           <p>${title}</p>
      //                       </div>
      //                       <div class="col-md-2">
      //                           <h6>Description:</h6>
      //                           <p>${body}</p>
      //                       </div>
      //                       <div class="col-md-2">
      //                           <h6>$$ Price:</h6>
      //                           <p>${price}</p>
      //                       </div>
      //                       <div class="col-md-2">
      //                           <h6>Day of Week:</h6>
      //                           <p>${dow}</p>
      //                       </div>
      //                       <div class="col-md-2">
      //                           <h6>Category:</h6>
      //                           <p>${cat}</p>
      //                   </div>
      //               </div> `);
    }
  }); // end AJAX, get all tasks







            
  $("#categorySubmit").on("click", function(event) {
    $("#userTasks").empty();
    event.preventDefault();
    $.ajax("/api/tasks/category/" + $('#categorySelect').val(), {
      type: "GET",
    }).then(function(dbTasks) {
      console.log('dbTasks', dbTasks);
      var tasksArray = dbTasks;
      for (let i = 0; i < tasksArray.length; i++) {
        let title = tasksArray[i].title;
        let body = tasksArray[i].body;
        let price = tasksArray[i].price;
        let dow = tasksArray[i].dayofWeek;
        let cat = tasksArray[i].category;
        let taskid = tasksArray[i].id;
        // let glypicon1 = (<span onclick="editTask()"><i class="fas fa-edit glypiconSpace"></i></span>)
        var newrow = $("<tr>");
        // newrow.attr("data-key2", taskid)
        newrow.append($("<td class='text-left'>" + title + "</td>"));
        newrow.append($("<td class='text-left'>" + body + "</td>"));
        newrow.append($("<td class='text-left'>" + price + "</td>"));
        newrow.append($("<td class='text-left'>" + dow + "</td>"));
        newrow.append($("<td class='text-left'>" + cat + "</td>"));
        newrow.append($("<td><span onclick=bookTask() i class='fas fa-check-square glypiconSpace' data='" + taskid + "'></i></td>"))
        $("#userTasks").append(newrow);
        
        // $("#userPostedTask").empty();
        // $("#userPostedTask").append(
        //   `
        //               <div class="row">
        //                   <div class="col-md-2">
        //                       <h6>Task:</h6>
        //                           <p>${title}</p>
        //                       </div>
        //                       <div class="col-md-2">
        //                           <h6>Description:</h6>
        //                           <p>${body}</p>
        //                       </div>
        //                       <div class="col-md-2">
        //                           <h6>$$ Price:</h6>
        //                           <p>${price}</p>
        //                       </div>
        //                       <div class="col-md-2">
        //                           <h6>Day of Week:</h6>
        //                           <p>${dow}</p>
        //                       </div>
        //                       <div class="col-md-2">
        //                           <h6>Category:</h6>
        //                           <p>${cat}</p>
        //                   </div>
        //               </div>
        //           `
        // );
      }
    }); // end AJAX, get all tasks
  }); // end filter by category


    function bookTask() {

        console.log("book")
        // MODEL BOX
        var id = ($(this).attr("data"));
        console.log(id)
      }

</script>

</html>
